#Python中的浅复制与深复制
2015-10-04<br />  
在Python中有这样一种情况，如下:  

    >>> ls = [1,2,3]
    >>> M = ls
    >>> ls[0] = 100
    >>> ls
    [100,2,3]
    >>> M
    [100,2,3]     #M也发生了改变!
&nbsp;&nbsp;&nbsp;上面的示例中M也发生了改变，这是因为直接的赋值操作，使得`M`和`ls`引用的是同一个对象，有时候，这并不是我们想要的情况，当我们想要两个变量引用不同的对象时，就要用到复制操作了.而复制操作可以分为浅复制(**shadow copy**)和深复制(**deep copy**)两种，在Python中，**这两种复制操作的区别仅当要复制的对象存在嵌套结构时才会显现出来**，下面分别来讨论这两种复制操作.
##浅复制(Shadow Copy)
**浅复制只能复制要复制对象的最顶层的结构,但不能复制嵌套部分，对于嵌套部分，两个变量依然是引用同一个对象**.  
对于列表而言，进行浅复制可以直接使用分片操作，示例如下:  

    >>> ls = [1,2,3]
    >>> M = ls[:]
    >>> ls[0] = 100
    >>> ls
    [100,2,3]
    >>> M
    [1,2,3]     #M没有发生改变
上面的示例中，采用浅复制操作后，`M`和`ls`引用的不是同一个对象，因此`ls`的改变不会影响到`M`.  
&nbsp;&nbsp;&nbsp;使用分片操作虽然便捷，但它只适用于列表，对于其他对象，就不能够使用分片操作了。在**`copy`**模块中有一个**`copy()`**函数，它是一个可以进行浅复制的通用函数，任何对象都可以使用它来进行浅复制操作,示例如下:  

    >>> import copy
    >>> ls = [1,2,3]
    >>> M = copy.copy(ls)
    >>> ls[0] = 100
    >>> ls
    [100,2,3]
    >>> M
    [1,2,3]
由上面示例可见使用**`copy()`**与使用分片操作效果相同.  
##深复制(Deep Copy)
**深复制除了可以复制要复制对象的最顶层结构，如果对象还存在嵌套结构的话，深复制还可以复制对象的嵌套结构.**  
下面首先来看一个浅复制的不足:  

    >>> ls = [[1,2],[3,4]]
    >>> M = ls[:]
    >>> ls[0][0] = 100
    >>> ls
    [[100,2],[3,4]]
    >>> M
    [[100,2],[3,4]]     #M也发生了改变
&nbsp;&nbsp;&nbsp;上面的示例中，`ls`的改变也影响到了`M`,这是因为`ls`存在嵌套结构，对于嵌套结构中的内容，浅复制操作并不进行复制，因此`ls`和`M`对于嵌套部分仍然引用的是同一个对象。要解决这个问题，就要使用深复制了，此时可以使用**`copy`**模块中的**`deepcopy()`**函数，示例如下:  

    >>> import copy
    >>> ls = [[1,2],[3,4]]
    >>> M = copy.deepcopy(ls)
    >>> ls[0][0] = 100
    >>> ls
    [[100,2],[3,4]]
    >>> M
    [[1,2],[3,4]]    #M没有发生发生改变
由上面的示例可以看出，深复制操作解决了这个问题. <br /><br />  
一如既往，如果你对文章中的内容有任何疑问，或者是发现文章中有任何错误，都可以通过下面的地址发邮件告诉我.  
E-mail: rytubuntulinux@gmail.com <br /><br />  

