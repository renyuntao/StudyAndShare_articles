# 如何解决U盘容量变小的问题?             
<!--       
2016-08-13
--> <br /><br />

## U盘容量会变小吗？               
如果你有这个疑问，那么说明你还没有遇到过U盘容量变小这样的问题，不过，U盘容量变小这个问题确实会在某些情况下发生。如果你只是简单地地使用U盘来存储数据，而不去对U盘进行其他操作，或将U盘用作其他的目的，那么你一般是不会遇到U盘容量变小这样的问题的。                 
               
U盘在如下两种情况下容量会变小:               
          
- **将U盘分成多个分区** 由于 **[Windows 系统中只能识别U盘的第一个分区](https://superuser.com/questions/400560/windows-7-doesnt-recognize-second-partition-on-removable-disk)**, 因此，如果你将U盘分为两个或更多个分区，那么在 Windows 系统中，你只能看到和使用U盘的第一个分区(作为一名Linux用户，在这一点上感到十分自豪，Linux可以完美地识别U盘中的所有分区**:)**)，于是U盘的容量就这样变小了。                
- **没有正确格式化U盘** 无论是在 Windows 系统中，还是在 Linux 系统中，都只能显示使用U盘中被正确格式化的区域，如果由于某些原因，你没有正确格式化U盘，那么在电脑上就只能显示被正确格式化的部分的容量，从而导致U盘容量变小。这种情况常常发生在将U盘作为系统启动盘时，如果你对此感兴趣，那么可以按照如下步骤操作，之后，你的U判断的容量就会变小:              
            
	1. 下载一个系统镜像文件(*.iso文件)
	2. 利用相应的工具将系统镜像(Windows 系统中可以使用 UltraISO, Ubuntu中可以使用启动盘创建器(**Startup Disk Creator**))写入到U盘中
	3. 完成步骤2后，再重复一遍步骤2,即利用相应的工具将系统镜像再向U盘中写入一次
	4. 格式化U盘

完成上面的4个步骤后，将U盘弹出，之后再插到电脑的USB端口上,此时查看U盘的容量，你会发现U盘的容量已经变小了。                

## 如何解决这个问题？
上面介绍了U盘变小的两种情况，下面介绍如何解决U盘容量变小这个问题。                 
            
### Linux系统中的解决方法            
作为一名 Linux 用户，当然首先介绍如何在 Linux 平台下解决这个问题了，Windows 平台下的解决方案在下一部分介绍，如果你是一名 Windows 用户，并且对 Linux 平台下的解决方案不感兴趣，可以跳过这一部分内容，直接看下一部分。                    
               
Linux 平台下解决方案的操作步骤如下:           
           
1. 将容量变小的U盘插入到电脑的USB端口            
2. 按 `Ctrl`+`Alt`+`t` 组合键打开终端，并执行如下命令:           
	
	```bash
	$ sudo fdisk -l
	```
	在输出结果的末尾，你会看到类似(**但不会完全相同**)下面的内容:              
	           
	Disk **/dev/sdb**: 7969 MB, 7969169408 bytes                         
	255 heads, 63 sectors/track, 968 cylinders, total 15564784 sectors            
	Units = 扇区 of 1 * 512 = 512 bytes                   
	Sector size (logical/physical): 512 bytes / 512 bytes             
	I/O size (minimum/optimal): 512 bytes / 512 bytes                 
	Disk identifier: 0x00000000                               
                                                             
	  设备 启动      起点          终点     块数   Id  系统               
	   /dev/sdb1            2048    15562751     7780352    b  W95 FAT32                
3. 卸载U盘                  
	在继续下面的操作之前，你应该首先将U盘卸载掉，卸载U盘的命令如下:                  

	```bash
	$ sudo umount /dev/sdb
	```
	**注意:** 你应该将上面命令中的 `/dev/sdb` 替换为你在步骤2中的输出结果中的红色字体部分。       
4. 删除U盘中的所有分区                  
	在终端执行如下命令:               
	
	```bash
	$ sudo fdisk /dev/sdb
	```

	同样，执行上述命令时，你应该将 `/dev/sdb` 替换为你在步骤2中的输出结果中的红色字体部分。                   

	之后你在终端会看到下面的提示:             
	         
	```bash
	命令(输入 m 获取帮助)：
	```
	接下来输入字母 `p`, 并按回车,之后你会看到当前U盘中的所有分区，输出结果与下面的类似(**但不会完全相同**):               

	```bash
	设备 启动      起点          终点     块数   Id  系统
	/dev/sdb1            2048    15562751     7780352    b  W95 FAT32
	```

	其中，跟在 `/dev/sdb` 后面的数字(在上面的例子中，即为数字1),即为分区号。                    
	接下来你所要做的就是删除U盘中的所有分区，在终端输入字母 `d` 并按下回车，之后会提示你输入要删除的分区的分区号，你应该根据你在上一步中看到的分区号，来输入相应的数字，应当注意的是，一次只能删除一个一个分区，要删除所有的分区，你需要多次执行上面的操作，直到你收到下面的提示:                 
	             
	```bash
	No partition is defined yet!
	```
	这样U盘中的所有分区就被删除了。                 
5. 为U盘创建一个新的分区                  
	紧接着步骤3中的操作，当你在终端收到 `No partition is defined yet!` 的提示后，输入字母 `n`, 并按下回车,之后，`fdisk` 将会询问你如何创建一个新的分区，此时你只要选择默认值，即对每一次询问都以回车键回应即可。                   
6. 确认修改并退出                
	当你确信你所做的操作准确无误后，可以按下 `w` 键来确认刚刚对U盘所做的修改并退出;否则，你应该按下 `q` 键退出，这样前面所做的操作就会被取消。   
7. 格式化U盘                 
	分区创建完毕之后，接下来要做的就是格式化U盘了，命令如下:               
	        
	```bash
	$ sudo mkfs.fat -F 32 -n TechForGeek /dev/sdb1
	```
	上述命令中 `-F 32` 表示将U盘格式化为FAT32文件系统，`-n TechForGeek` 表示将U盘的卷名(**Volumn Name**)设置为 TechForGeek。           
	完成上述步骤后，拔出U盘，之后再将U盘插入到电脑的USB端口，此时查看U盘的容量大小，你会发现它已经恢复到了它原本的大小。                 

### Windows 系统中的解决方法
在 Windows 系统中解决U盘容量变小的问题，需要使用 `diskpart` 这个工具，`diskpart` 是 Windows 系统下的一个命令行工具，用来查看和配置磁盘分区的属性。            
    
使用 `diskpart` 解决U盘容量变小的具体操作步骤如下:            
            
1. 将容量变小的U盘插入到电脑的USB端口             
2. 按下 `Windows`+`r` 组合键，在弹出的窗口里输入 `cmd` 并按下回车键，之后会打开一个黑色背景的命令行输入窗口。             
3. 在命令行提示符后面输入 `diskpart`并按下回车来启动 `diskpart`， 之后你会进入到 `diskpart` 程序之中                    
4. 继续输入下面的命令并按下回车键:                
	
	```bash
	list disk
	```
	上面这个命令用来列出当前系统中所有检测到的磁盘(当然也包括你刚刚插到电脑上的U盘)               
5. 执行如下命令选择要操作的磁盘:            
	select disk **1**           
         
	**注意，你应该根据步骤4中的输出结果，选择你的U盘(可以根据磁盘的大小来判断哪个表示你的U盘)的编号来替换上述命令中的红色体部分。**          
6. 查看U盘的所有分区                
	你可以执行如下命令来查看U盘中的所有分区:              

	```bash
	list partition
	```
	从输出结果中你会看到你的U盘中的所有分区。                  
7. 删除U盘中的所有分区                       
	执行如下命令删除U盘中所有的分区:              

	```
	clean
	```
	为了确认U盘的所有分区确实被删除了，你可以再次执行如下命令来查看:                 
	        
	```
	list partition
	```
	如果U盘的所有分区都被删除的话，上述命令不会输出任何东西。                
8. 为U盘创建一个分区             
	执行如下命令为U盘创建一个主分区:              

	```
	create partition primary
	```
	之后再次执行下面的命令，你就会看到刚刚创建的分区:                

	```
	list partition
	```
9. 格式化U盘          
	接下来要做的就是格式化U盘，命令如下:                
	
	```
	format fs=fat32 quick
	```
	**注意，上面的命令会运行一段时间，所以你需要耐心等待。**                   
10. 退出 `diskpart`             
	现在所有的事情都做好了，你可以执行如下命令退出 `diskpart` 了:            

	```
	exit
	```

完成上面的所有操作后，U盘的容量就会恢复到它原本的大小了。                   

## 结束语                  
U盘容量变小这种情况，对于一般用户而言，并不常见，但如果遇到这样的问题，又令人十分烦恼。这篇文章解释了在哪些情况下会遇到U盘容量变小这样的问题，以及遇到这样的问题后，如何在 Linux 和 Windows 系统中解决这样的问题,无论是在 Linux 系统中，还是在 Windows 系统中，解决这个问题的总体思路是相同的，即首先将U盘中的所有分区删除掉，之后再为U盘创建一个新的分区，使得这个区分的容量等同于U盘的容量大小，最后格式化这个新建的分区。如果你遇到U盘容量变小这样的问题，希望这篇文章可以帮助到你。                        

<!--
Reference:
[SuperUser](https://superuser.com/questions/752874/16-gb-usb-flash-drive-capacity-down-to-938-mb)                  
       
[makeuseof](http://www.makeuseof.com/answers/why-has-the-capacity-of-my-pen-drive-shrinked-from-16-gb-to-64-mb-after-trying-to-format-it/)       
-->
